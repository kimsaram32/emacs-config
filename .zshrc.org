#+property: header-args :tangle out/.zshrc

* Start profiling
#+begin_src zsh
  zmodload zsh/zprof
#+end_src
* Start tmux on WezTerm
#+begin_src bash
  if [[ ("$TERM_PROGRAM" == "WezTerm") && -z "$(tmux list-clients 2>/dev/null)" ]]; then
      exec tmux new -As main;
  fi
#+end_src
* Powerlevel10k instant prompt
Enable Powerlevel10k instant prompt. Should stay close to the top of ~/.zshrc.
Initialization code that may require console input (password prompts, [y/n]
confirmations, etc.) must go above this block; everything else may go below.

#+begin_src zsh
  if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
    source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
  fi
#+end_src
* Lang
#+begin_src zsh
export LANG="en_US.UTF-8"
#+end_src
* Brew
#+begin_src zsh
alias brewup="brew update && brew upgrade && brew doctor"
#+end_src
* Antidote
#+begin_src zsh
  source /opt/homebrew/opt/antidote/share/antidote/antidote.zsh
  antidote load
#+end_src
* Powerlevel10k
#+begin_src zsh
  # To customize prompt, run `p10k configure` or edit ~/.p10k.zsh.
  [[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
#+end_src
* Directories
#+begin_src zsh
  DIR_WS="$HOME/me/ws"
  DIR_DOTFILES="$HOME/me/dotfiles"

  w () {
      cd "$DIR_WS/$1"
  }

  wl () {
      cd "$DIR_WS/learnings/$1"
  }

  wp () {
      cd "$DIR_WS/projects/$1"
  }

  wo () {
      cd "$DIR_WS/others/$1"
  }

  alias d="cd $DIR_DOTFILES"
#+end_src
* Aliases
#+begin_src zsh
  alias g="git"
  alias l="ls -lah"
#+end_src
* Scripts
#+begin_src zsh
export PATH="/Users/kimsaram32/me/ws/bin:$PATH"
#+end_src
* PostgreSQL
#+begin_src zsh
export PATH="/opt/homebrew/opt/postgresql@16/bin:$PATH"
#+end_src
* fzf
** Default options
#+begin_src zsh
export FZF_DEFAULT_OPTS=" \
  --preview 'bat --color=always {}' --preview-window up \
  --bind \"ctrl-y:execute-silent(basename {} | cut -d . -f1 | tr -d '\n' | pbcopy)\" \
  --bind \"ctrl-o:execute-silent[ \
    tmux select-pane -R
    tmux send-keys :e Space && \
    tmux send-keys -l {} && \
    tmux send-keys Enter \
  ]\""
#+end_src
** Integration with rg
#+begin_src zsh
fif () {
  if [ ! "$#" -gt 0 ]
  then
    echo "Need a string to search for!"
    return 1
  fi
  rg --files-with-matches --no-messages -i "$1" $PWD | \
  fzf --delimiter / --with-nth -1 \
    --preview "highlight -O ansi -l {} 2> /dev/null | rg --colors 'match:bg:yellow' --ignore-case --pretty --context 10 '$1' || rg --ignore-case --pretty --context 10 '$1' {}"
}
#+end_src
* restic
#+begin_src zsh
export RESTIC_REPOSITORY=/Volumes/What/backups
export RESTIC_PASSWORD_FILE=~/.restic_password
#+end_src
* gnu-sed
#+begin_src zsh
export PATH="/opt/homebrew/opt/gnu-sed/libexec/gnubin:$PATH"
#+end_src
* pnpm
#+begin_src zsh
export PNPM_HOME="/Users/kimsaram32/Library/pnpm"
export PATH="$PNPM_HOME:$PATH"
#+end_src
* Corepack
#+begin_src zsh
alias yarn="corepack yarn"
alias yarnpkg="corepack yarnpkg"
alias pnpm="corepack pnpm"
alias pnpx="corepack pnpx"
alias npm="corepack npm"
alias npx="corepack npx"
#+end_src
* deno
#+begin_src zsh
export PATH="/Users/kimsaram32/.deno/bin:$PATH"
#+end_src
* nvm
#+begin_src zsh
  export NVM_DIR="$HOME/.nvm"
  export NVM_ROOT="/opt/homebrew/opt/nvm"

  lazyload node nvm -- '[ -s "$NVM_ROOT/nvm.sh" ] && \. "$NVM_ROOT/nvm.sh"
  	   [ -s "$NVM_ROOT/etc/bash_completion.d/nvm" ] && \. "$NVM_ROOT/etc/bash_completion.d/nvm"
  '
#+end_src
* Jenv
#+begin_src zsh
  export PATH="$HOME/.jenv/bin:$PATH"
  lazyload jenv java -- 'eval "$(jenv init -)"'
#+end_src
* uv
#+begin_src zsh
export PATH="$HOME/.local/bin/:$PATH"
#+end_src
* mise
#+begin_src zsh
eval "$(mise activate zsh)"
export PATH=$PATH:$HOME/zk/bin
#+end_src
* go
#+begin_src zsh
export GOPATH="/Users/kimsaram32/go"
export PATH="$GOPATH/bin:$PATH"
#+end_src
* Google Cloud SDK
#+begin_src zsh
# The next line updates PATH for the Google Cloud SDK.
if [ -f '/Users/kimsaram32/.local/google-cloud-sdk/path.zsh.inc' ]; then . '/Users/kimsaram32/.local/google-cloud-sdk/path.zsh.inc'; fi

# The next line enables shell command completion for gcloud.
if [ -f '/Users/kimsaram32/.local/google-cloud-sdk/completion.zsh.inc' ]; then . '/Users/kimsaram32/.local/google-cloud-sdk/completion.zsh.inc'; fi
#+end_src
* Anaconda
#+begin_src zsh
__conda_setup="$('/opt/anaconda3/bin/conda' 'shell.zsh' 'hook' 2> /dev/null)"
if [ $? -eq 0 ]; then
    eval "$__conda_setup"
else
    if [ -f "/opt/anaconda3/etc/profile.d/conda.sh" ]; then
        . "/opt/anaconda3/etc/profile.d/conda.sh"
    else
        export PATH="/opt/anaconda3/bin:$PATH"
    fi
fi
unset __conda_setup
#+end_src
* End profiling
#+begin_src zsh :tangle no
  zprof
#+end_src
